<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{title}}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            surface: '#1a1a2e',
            deep: '#0f0f23',
            'deep-alt': '#16162b',
            border: '#2a2a4a',
            accent: '#667eea',
            'accent-end': '#764ba2',
            purple: '#a78bfa',
            green: '#4ade80',
            sky: '#7dd3fc',
            'sky-bright': '#38bdf8',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-deep text-gray-300 min-h-screen flex justify-center items-center font-[system-ui,-apple-system,BlinkMacSystemFont,'Segoe_UI',Roboto,sans-serif]">
  <div class="bg-surface border border-border rounded-xl p-10 max-w-[520px] w-full shadow-[0_8px_32px_rgba(0,0,0,0.4)]">

    <!-- Logo -->
    <div class="text-center mb-6">
      <span class="text-[28px] font-bold bg-gradient-to-br from-accent to-accent-end bg-clip-text text-transparent">DotBot</span><br>
      <span class="inline-block bg-[#1e3a2f] text-green text-[11px] font-semibold px-2.5 py-0.5 rounded-full mt-2 tracking-wide">SECURE CREDENTIAL ENTRY</span>
    </div>

    <!-- Domain scope -->
    <div class="text-center my-3 px-4 py-1.5 bg-[#162032] border border-[#1e3a5f] rounded-md text-[13px] text-sky">
      Scoped to: <strong class="text-sky-bright">{{allowedDomain}}</strong>
    </div>

    <!-- Prompt -->
    <div class="bg-deep-alt border border-border rounded-lg p-4 my-5 text-sm leading-relaxed">{{prompt}}</div>

    <!-- Form -->
    <form method="POST" action="/credentials/submit" id="credForm">
      <input type="hidden" name="token" value="{{token}}">

      <label class="block text-[13px] text-gray-500 mb-2">
        Enter value for <span class="text-purple font-mono text-[13px]">{{keyName}}</span>
      </label>
      <input type="password" name="value" id="valueInput" required autocomplete="off" autofocus
             placeholder="Paste or type your credential here"
             class="w-full px-4 py-3 bg-deep border border-[#333366] rounded-lg text-gray-300 font-mono text-sm outline-none transition-colors focus:border-accent">

      <div class="flex items-center gap-2 my-3 mb-6 text-[13px] text-gray-500">
        <input type="checkbox" id="showToggle" class="w-4 h-4 accent-accent">
        <label for="showToggle" class="cursor-pointer">Show value</label>
      </div>

      <button type="submit" id="submitBtn"
              class="w-full py-3.5 bg-gradient-to-br from-accent to-accent-end text-white border-none rounded-lg text-[15px] font-semibold cursor-pointer transition-opacity hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed">
        Store Securely
      </button>
    </form>

    <!-- Security note -->
    <div class="mt-5 p-3 bg-[#1e1e3a] rounded-lg text-xs text-gray-500 leading-relaxed">
      <strong class="text-green">&#x1f512; Security:</strong> This credential is encrypted with a server-side key and
      cryptographically bound to <strong class="text-green">{{allowedDomain}}</strong>. It can only be used
      for API calls to that domain &mdash; it cannot be exfiltrated to any other destination.
      The LLM never sees the real value.
    </div>

    <!-- QR code (conditionally rendered by template engine) -->
    {{qrBlock}}
  </div>

  <script>
    const input = document.getElementById('valueInput');
    const toggle = document.getElementById('showToggle');
    const form = document.getElementById('credForm');
    const btn = document.getElementById('submitBtn');

    toggle.addEventListener('change', () => {
      input.type = toggle.checked ? 'text' : 'password';
    });

    form.addEventListener('submit', () => {
      btn.disabled = true;
      btn.textContent = 'Encrypting\u2026';
    });
  </script>
</body>
</html>
